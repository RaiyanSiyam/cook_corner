<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cook_Corner | Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
  <style>
    :root{
      --brand-blue:#3b82f6;
      --brand-amber:#f59e0b;
      --brand-pink:#ec4899;
    }
    /* Aurora gradient background to match login page */
    body{
      background:
        radial-gradient(1200px 800px at 10% -10%, rgba(59,130,246,.18), transparent 60%),
        radial-gradient(1200px 800px at 110% 30%, rgba(245,158,11,.18), transparent 60%),
        radial-gradient(800px 800px at 50% 120%, rgba(236,72,153,.15), transparent 60%),
        #f9fafb;
      background-size: 100% 100%;
    }
    /* Frosted glass effect to match login page */
    .form-container{
        backdrop-filter: blur(16px) saturate(180%);
        -webkit-backdrop-filter: blur(16px) saturate(180%);
        background-color: rgba(255, 255, 255, 0.75);
        border-radius: 12px;
        border: 1px solid rgba(209, 213, 219, 0.3);
    }
    .pulse { animation: pulse-grow 1s ease-out; }
    @keyframes pulse-grow {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

  <div class="w-full max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden" data-aos="fade-up">
    
    <!-- Form Panel -->
    <div class="form-container p-8 sm:p-12 flex flex-col justify-center order-last md:order-first">
      <div class="w-full">
        <div class="text-center mb-8">
            <a href="index.php" class="text-3xl font-bold text-gray-800">Cook_Corner</a>
            <h2 class="mt-2 text-2xl font-bold text-gray-900">Create Your Account</h2>
            <p class="mt-1 text-gray-600">Join our community of food lovers!</p>
        </div>

        <form id="signupForm" class="space-y-5">
            <!-- Error/Success Message Div -->
            <div id="msg" class="hidden p-4 rounded-md text-sm"></div>

            <div>
                <label for="name" class="sr-only">Full Name</label>
                <div class="relative">
                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <i data-feather="user" class="h-5 w-5 text-gray-400"></i>
                    </div>
                    <input id="name" name="name" type="text" required class="block w-full rounded-md border-gray-300 pl-10 py-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Full Name">
                </div>
            </div>

            <div>
                <label for="email" class="sr-only">Email</label>
                <div class="relative">
                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <i data-feather="mail" class="h-5 w-5 text-gray-400"></i>
                    </div>
                    <input id="email" name="email" type="email" autocomplete="email" required class="block w-full rounded-md border-gray-300 pl-10 py-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="your@email.com">
                </div>
            </div>

            <div>
                <label for="password" class="sr-only">Password</label>
                <div class="relative">
                     <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <i data-feather="lock" class="h-5 w-5 text-gray-400"></i>
                    </div>
                    <input id="password" name="password" type="password" required class="block w-full rounded-md border-gray-300 pl-10 py-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Password (min. 8 characters)">
                </div>
            </div>

            <div>
                <label for="password_confirm" class="sr-only">Confirm Password</label>
                <div class="relative">
                     <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <i data-feather="key" class="h-5 w-5 text-gray-400"></i>
                    </div>
                    <input id="password_confirm" name="password_confirm" type="password" required class="block w-full rounded-md border-gray-300 pl-10 py-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Confirm Password">
                </div>
            </div>
            
            <button id="signupBtn" type="submit" class="w-full flex items-center justify-center gap-2 py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-300">
              <i data-feather="user-plus" class="w-4 h-4"></i>
              <span>Create Account</span>
            </button>
        </form>

        <p class="mt-8 text-center text-sm text-gray-600">
            Already have an account?
            <a href="login.html" class="font-medium text-blue-600 hover:text-blue-500">Sign in</a>
        </p>
      </div>
    </div>
    
    <!-- Image Panel -->
    <div class="hidden md:block">
      <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=800&q=80" alt="Delicious plate of food" class="w-full h-full object-cover">
    </div>

  </div>

<script>
    AOS.init();
    feather.replace();

    const form = document.getElementById('signupForm');
    const msg = document.getElementById('msg');
    const signupBtn = document.getElementById('signupBtn');
    const nameEl = document.getElementById('name');
    const emailEl = document.getElementById('email');
    const pw = document.getElementById('password');
    const pw2 = document.getElementById('password_confirm');

    const showMsg = (message, type = 'error') => {
        msg.textContent = message;
        msg.className = `p-4 rounded-md text-sm ${type === 'error' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`;
        msg.classList.remove('hidden');
    };

    const doSignup = async (payload) => {
        const response = await fetch('signup.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams(payload)
        });
        const data = await response.json();
        if (!data.ok) {
            throw new Error(data.error || 'Unknown error occurred.');
        }
        return data;
    };

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        msg.classList.add('hidden');

        const n = nameEl.value.trim();
        const eVal = emailEl.value.trim();
        const p1 = pw.value;
        const p2 = pw2.value;

        if (!n || !eVal || !p1 || !p2) { showMsg('Please fill out all fields.', 'error'); return; }
        if (p1.length < 8) { showMsg('Password must be at least 8 characters.', 'error'); return; }
        if (p1 !== p2) { showMsg('Passwords do not match.', 'error'); return; }
        
        signupBtn.disabled = true;
        const originalText = signupBtn.innerHTML;
        signupBtn.innerHTML = '<i data-feather="loader" class="w-5 h-5 animate-spin mx-auto"></i> <span>Creating Account...</span>';
        feather.replace();

        try {
            const payload = { name: n, email: eVal, password: p1, password_confirm: p2 };
            const data = await doSignup(payload);
            
            showMsg('Account created! Redirecting to loginâ€¦', 'success');
            signupBtn.innerHTML = '<i data-feather="check-circle" class="w-5 h-5"></i> <span>Success!</span>';
            signupBtn.classList.add('pulse', 'bg-green-500');
            feather.replace();

            setTimeout(() => {
                window.location.href = data.redirect || 'login.html';
            }, 1000);
        } catch (err) {
            showMsg(err.message || 'Signup failed. Please try again.', 'error');
            signupBtn.disabled = false;
            signupBtn.innerHTML = originalText;
            feather.replace();
        }
    });
</script>
</body>
</html>

